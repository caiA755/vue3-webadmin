{"ast":null,"code":"// import NavMenu from '@/components/nav_menu'\nimport localCache from '@/utils/cache';\nimport { Flag } from '@element-plus/icons-vue';\nimport { getCurrentInstance } from \"vue\";\nimport mapMenusToRouter from '@/utils/map_menus.js';\nimport pathMapToMenu from '@/utils/path_menus.js';\nimport router from '@/router';\nimport { toRaw } from '@vue/reactivity';\nimport { RouteRecordRaw } from 'vue-router';\nexport default {\n  props: {\n    width: String\n  },\n\n  data() {\n    return {\n      iscollapse: false,\n      userMenus: localCache.getCache(\"menuinfo\"),\n      isShow: true,\n      defaultvalue: 'v5DBVVVJ'\n    };\n  },\n\n  created() {\n    let menus = Array.from(toRaw(this.userMenus));\n    let routes = mapMenusToRouter(menus);\n\n    for (var i = 0; i < routes.length; i++) {\n      router.options.routes.push(routes[i]);\n      router.addRoute('main', routes[i]);\n      console.log(router);\n      const currentPath = this.$route.path;\n      console.log(\"当前路由\", currentPath);\n      console.log(\"当前的菜单\", menus);\n      const currentMenu = pathMapToMenu(menus, currentPath);\n      this.defaultvalue = currentMenu.objectId;\n    }\n  },\n\n  methods: {\n    menuItemClick(item) {\n      console.log(item.url);\n      this.$router.push({\n        path: `${item.url}`\n      });\n    }\n\n  },\n  emits: [\"success\"],\n\n  setup(props, {\n    emit\n  }) {\n    let instance = getCurrentInstance();\n\n    const select = () => {\n      if (instance.data.iscollapse) {\n        emit('success', '270px');\n        instance.data.iscollapse = false;\n        instance.data.isShow = true;\n      } else {\n        emit('success', '100px');\n        instance.data.iscollapse = true;\n        instance.data.isShow = false;\n      }\n    };\n\n    return {\n      select\n    };\n  }\n\n};","map":{"version":3,"mappings":"AAyCA;AACA,OAAOA,UAAP,MAAuB,eAAvB;AACA,SAASC,IAAT,QAAqB,yBAArB;AACA,SAASC,kBAAT,QAAmC,KAAnC;AACA,OAAQC,gBAAR,MAA8B,sBAA9B;AACA,OAAQC,aAAR,MAA2B,uBAA3B;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,SAASC,KAAT,QAAsB,iBAAtB;AACA,SAAQC,cAAR,QAA6B,YAA7B;AAEA,eAAe;EACbC,KAAK,EAAE;IACHC,KAAK,EAAEC;EADJ,CADM;;EAKbC,IAAI,GAAE;IACJ,OAAO;MACLC,UAAU,EAAC,KADN;MAELC,SAAS,EAACb,UAAU,CAACc,QAAX,CAAoB,UAApB,CAFL;MAGLC,MAAM,EAAC,IAHF;MAILC,YAAY,EAAC;IAJR,CAAP;EAMD,CAZY;;EAaZC,OAAO,GAAE;IACH,IAAIC,KAAK,GAACC,KAAK,CAACC,IAAN,CAAWd,KAAK,CAAC,KAAKO,SAAN,CAAhB,CAAV;IACA,IAAIQ,MAAM,GAAClB,gBAAgB,CAACe,KAAD,CAA3B;;IACA,KAAI,IAAII,CAAC,GAAC,CAAV,EAAaA,CAAC,GAACD,MAAM,CAACE,MAAtB,EAA8BD,CAAC,EAA/B,EAAmC;MAClCjB,MAAM,CAACmB,OAAP,CAAeH,MAAf,CAAsBI,IAAtB,CAA2BJ,MAAM,CAACC,CAAD,CAAjC;MACAjB,MAAM,CAACqB,QAAP,CAAgB,MAAhB,EAAwBL,MAAM,CAACC,CAAD,CAA9B;MACDK,OAAO,CAACC,GAAR,CAAYvB,MAAZ;MACA,MAAMwB,WAAW,GAAC,KAAKC,MAAL,CAAYC,IAA9B;MACAJ,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAmBC,WAAnB;MACAF,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAoBV,KAApB;MACA,MAAMc,WAAW,GAAC5B,aAAa,CAACc,KAAD,EAAOW,WAAP,CAA/B;MACA,KAAKb,YAAL,GAAkBgB,WAAW,CAACC,QAA9B;IACN;EACC,CA1BW;;EA2BZC,OAAO,EAAC;IACJC,aAAa,CAACC,IAAD,EAAM;MACjBT,OAAO,CAACC,GAAR,CAAYQ,IAAI,CAACC,GAAjB;MACC,KAAKC,OAAL,CAAab,IAAb,CAAkB;QAACM,IAAI,EAAE,GAAEK,IAAI,CAACC,GAAI;MAAlB,CAAlB;IACJ;;EAJK,CA3BI;EAiCZE,KAAK,EAAE,CAAC,SAAD,CAjCK;;EAkCZC,KAAK,CAAChC,KAAD,EAAO;IAACiC;EAAD,CAAP,EAAe;IACnB,IAAIC,QAAQ,GAACxC,kBAAkB,EAA/B;;IACA,MAAMyC,MAAM,GAAE,MAAM;MACZ,IAAGD,QAAQ,CAAC/B,IAAT,CAAcC,UAAjB,EAA4B;QACxB6B,IAAI,CAAC,SAAD,EAAY,OAAZ,CAAJ;QACAC,QAAQ,CAAC/B,IAAT,CAAcC,UAAd,GAAyB,KAAzB;QACA8B,QAAQ,CAAC/B,IAAT,CAAcI,MAAd,GAAqB,IAArB;MACH,CAJD,MAIK;QACA0B,IAAI,CAAC,SAAD,EAAY,OAAZ,CAAJ;QACAC,QAAQ,CAAC/B,IAAT,CAAcC,UAAd,GAAyB,IAAzB;QACA8B,QAAQ,CAAC/B,IAAT,CAAcI,MAAd,GAAqB,KAArB;MACL;IACP,CAVD;;IAWA,OAAO;MACL4B;IADK,CAAP;EAGD;;AAlDY,CAAf","names":["localCache","Flag","getCurrentInstance","mapMenusToRouter","pathMapToMenu","router","toRaw","RouteRecordRaw","props","width","String","data","iscollapse","userMenus","getCache","isShow","defaultvalue","created","menus","Array","from","routes","i","length","options","push","addRoute","console","log","currentPath","$route","path","currentMenu","objectId","methods","menuItemClick","item","url","$router","emits","setup","emit","instance","select"],"sourceRoot":"","sources":["E:\\CaiCai\\前端学习\\Vue学习\\job-web-vue3\\src\\components\\nav_menu\\src\\nav_menu.vue"],"sourcesContent":["<template>\r\n  <div id=\"nav_menu\">\r\n    <div class=\"logo\">\r\n     <img src=\"~@/assets/logo.png\"  width=\"20\" height=\"20\" alt=\"logo\"/>\r\n     <span v-if=\"isShow\">后台管理系统</span>\r\n     <el-icon @click=\"select()\"><Fold/></el-icon>\r\n    </div>\r\n     <div class=\"menu\">\r\n         <el-menu :default-openeds=\"[0]\"\r\n        :default-active=\"defaultvalue\"\r\n        :collapse=\"iscollapse\"\r\n        class=\"el-menu-vertical-demo\"\r\n      >\r\n        <template v-for=\"item in userMenus\" :key=\"item.objectId\">\r\n             <template v-if=\"item.type==1\">\r\n                <el-sub-menu index=\"{{item.objectId}}\">\r\n                   <template #title>\r\n                       <el-icon><Menu /></el-icon>\r\n                        <span>{{item.name}}</span>\r\n                    </template>\r\n                    <template v-for=\"subitem in item.children\" :key=\"subitem.objectId\">\r\n                   <el-menu-item  @click=\"menuItemClick(subitem)\" v-bind:index=\"subitem.objectId\">\r\n                        <el-icon><Reading /></el-icon>\r\n                        <span>{{subitem.name}}</span>\r\n                    </el-menu-item> \r\n                  </template>\r\n                </el-sub-menu>\r\n             </template>\r\n               <template v-else-if=\"item.type===3\">\r\n                <el-menu-item @click=\"menuItemClick(item)\" v-bind:index=\"item.objectId\">\r\n                    <el-icon><Menu /></el-icon>\r\n                    <span>{{item.name}}</span>\r\n                </el-menu-item> \r\n               </template>\r\n        </template>\r\n      </el-menu>\r\n     </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// import NavMenu from '@/components/nav_menu'\r\nimport localCache from '@/utils/cache'\r\nimport { Flag } from '@element-plus/icons-vue'\r\nimport { getCurrentInstance } from \"vue\";\r\nimport  mapMenusToRouter from '@/utils/map_menus.js'\r\nimport  pathMapToMenu from '@/utils/path_menus.js'\r\nimport router from '@/router';\r\nimport { toRaw } from '@vue/reactivity'\r\nimport {RouteRecordRaw} from 'vue-router'\r\n\r\nexport default {\r\n  props: {\r\n      width: String\r\n      \r\n  },\r\n  data(){\r\n    return {\r\n      iscollapse:false,\r\n      userMenus:localCache.getCache(\"menuinfo\"),\r\n      isShow:true,\r\n      defaultvalue:'v5DBVVVJ'\r\n    }\r\n  },\r\n   created(){\r\n         let menus=Array.from(toRaw(this.userMenus));\r\n         let routes=mapMenusToRouter(menus);\r\n         for(var i=0; i<routes.length; i++) {\r\n          router.options.routes.push(routes[i]);\r\n          router.addRoute('main', routes[i]);\r\n         console.log(router);\r\n         const currentPath=this.$route.path;\r\n         console.log(\"当前路由\",currentPath)\r\n         console.log(\"当前的菜单\",menus)\r\n         const currentMenu=pathMapToMenu(menus,currentPath);\r\n         this.defaultvalue=currentMenu.objectId;\r\n   }\r\n   }, \r\n   methods:{\r\n       menuItemClick(item){\r\n         console.log(item.url);\r\n          this.$router.push({path:`${item.url}`});  \r\n      }\r\n   },\r\n   emits: [\"success\"],\r\n   setup(props,{emit}) {\r\n    let instance=getCurrentInstance();\r\n    const select= () => { \r\n            if(instance.data.iscollapse){\r\n                emit('success', '270px') \r\n                instance.data.iscollapse=false; \r\n                instance.data.isShow=true;\r\n            }else{\r\n                 emit('success', '100px') \r\n                 instance.data.iscollapse=true;\r\n                 instance.data.isShow=false;\r\n            }\r\n    };\r\n    return {\r\n      select\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style>\r\n #nav_menu{\r\n    width: 100%;\r\n    \r\n }\r\n.logo{\r\n    /* border:1px solid red; */\r\n    height: 60px;\r\n    line-height: 60px;\r\n    color: white;\r\n    font-size: 17px;\r\n    font-weight: 600;\r\n    letter-spacing: 1px;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}