{"ast":null,"code":"import { createRouter, createWebHistory, createWebHashHistory } from \"vue-router\";\nimport { RouteRecordRaw } from 'vue-router';\nimport LoginPlane from \"../views/login/cpns/login-panel\";\nimport LoginName from \"../views/login/login-name\";\nimport MainName from '@/views/main/main-name';\nimport HelloWorld from '@/components/HelloWorld.vue';\nimport localCache from '@/utils/cache.js';\nimport mainurl from '@/service/url/mainurl';\nlet router = createRouter({\n  history: createWebHashHistory(),\n  routes: [// 路由列表，里面的每一个成员都是一个url地址和组件的映射关系\n  {\n    path: \"/\",\n    component: LoginName\n  }, {\n    name: \"main\",\n    path: \"/main\",\n    component: MainName\n  },, {\n    name: \"heallo\",\n    path: \"/heallo\",\n    component: HelloWorld\n  }],\n  children: [{\n    path: \"wu\",\n    name: \"wu\",\n    component: LoginPlane\n  }]\n});\nrouter.beforeEach((to, form) => {\n  let userinfo = localCache.getCache(\"userinfo\");\n  let roleid;\n  cRequest1.getRequest(mainurl.userroleUrl, `{\"user_id\":\"${userinfo.username}\"}&include=tb_user.username`).then(res => {\n    roleid = res.results[0].role_id.objectId;\n  });\n  console.log(roleid); //查询菜单 查询roleid 根据roleid显示不同的菜单\n\n  let menu_array = [];\n  let result;\n  cRequest1.getRequest(mainurl.rolemenuUrl, `{\"role_id\":\"${roleid}\"}&include=menu_id`).then(res => {\n    result = res.results;\n  }); //将菜单信息进行处理\n\n  result.forEach(element => {\n    if (element.menu_id.type === 1 || element.menu_id.type === 3) {\n      menu_array.push(element.menu_id);\n    }\n  });\n\n  for (let i = 0; i < menu_array.length; i++) {\n    cRequest1.getRequest(mainurl.menuUrl, `{\"parent_id\":\"${menu_array[i].objectId}\",\"type\":2}`).then(res => {\n      menu_array[i].children = res.results;\n    });\n  }\n\n  localCache.setCache(\"menuinfo\", menu_array);\n});\nexport default router;","map":{"version":3,"names":["createRouter","createWebHistory","createWebHashHistory","RouteRecordRaw","LoginPlane","LoginName","MainName","HelloWorld","localCache","mainurl","router","history","routes","path","component","name","children","beforeEach","to","form","userinfo","getCache","roleid","cRequest1","getRequest","userroleUrl","username","then","res","results","role_id","objectId","console","log","menu_array","result","rolemenuUrl","forEach","element","menu_id","type","push","i","length","menuUrl","setCache"],"sources":["E:/CaiCai/前端学习/Vue学习/job-web-vue3/src/router/index.js"],"sourcesContent":["import { createRouter, createWebHistory, createWebHashHistory } from \"vue-router\"\r\nimport { RouteRecordRaw } from 'vue-router'\r\n\r\nimport LoginPlane from \"../views/login/cpns/login-panel\";\r\nimport LoginName from \"../views/login/login-name\";\r\nimport MainName from '@/views/main/main-name'\r\nimport HelloWorld from '@/components/HelloWorld.vue'\r\nimport localCache from '@/utils/cache.js'\r\nimport mainurl from '@/service/url/mainurl'\r\n\r\nlet router = createRouter({\r\n    history: createWebHashHistory(),\r\n    routes: [ // 路由列表，里面的每一个成员都是一个url地址和组件的映射关系\r\n        {\r\n            path: \"/\",\r\n            component: LoginName,\r\n        },\r\n        {\r\n            name: \"main\",\r\n            path: \"/main\",\r\n            component: MainName,\r\n        }, ,\r\n        {\r\n            name: \"heallo\",\r\n            path: \"/heallo\",\r\n            component: HelloWorld,\r\n        }\r\n    ],\r\n    children: [{\r\n        path: \"wu\",\r\n        name: \"wu\",\r\n        component: LoginPlane\r\n    }]\r\n});\r\nrouter.beforeEach((to, form) => {\r\n    let userinfo = localCache.getCache(\"userinfo\");\r\n    let roleid;\r\n    cRequest1.getRequest(mainurl.userroleUrl, `{\"user_id\":\"${userinfo.username}\"}&include=tb_user.username`).then((res) => {\r\n        roleid = res.results[0].role_id.objectId;\r\n    })\r\n    console.log(roleid);\r\n    //查询菜单 查询roleid 根据roleid显示不同的菜单\r\n    let menu_array = [];\r\n    let result;\r\n    cRequest1.getRequest(mainurl.rolemenuUrl, `{\"role_id\":\"${roleid}\"}&include=menu_id`).then((res) => {\r\n            result = res.results;\r\n        })\r\n        //将菜单信息进行处理\r\n    result.forEach((element) => {\r\n        if (element.menu_id.type === 1 || element.menu_id.type === 3) {\r\n            menu_array.push(element.menu_id);\r\n        }\r\n    });\r\n\r\n    for (let i = 0; i < menu_array.length; i++) {\r\n        cRequest1.getRequest(mainurl.menuUrl, `{\"parent_id\":\"${menu_array[i].objectId}\",\"type\":2}`).then((res) => {\r\n            menu_array[i].children = res.results;\r\n        })\r\n    }\r\n    localCache.setCache(\"menuinfo\", menu_array);\r\n})\r\nexport default router"],"mappings":"AAAA,SAASA,YAAT,EAAuBC,gBAAvB,EAAyCC,oBAAzC,QAAqE,YAArE;AACA,SAASC,cAAT,QAA+B,YAA/B;AAEA,OAAOC,UAAP,MAAuB,iCAAvB;AACA,OAAOC,SAAP,MAAsB,2BAAtB;AACA,OAAOC,QAAP,MAAqB,wBAArB;AACA,OAAOC,UAAP,MAAuB,6BAAvB;AACA,OAAOC,UAAP,MAAuB,kBAAvB;AACA,OAAOC,OAAP,MAAoB,uBAApB;AAEA,IAAIC,MAAM,GAAGV,YAAY,CAAC;EACtBW,OAAO,EAAET,oBAAoB,EADP;EAEtBU,MAAM,EAAE,CAAE;EACN;IACIC,IAAI,EAAE,GADV;IAEIC,SAAS,EAAET;EAFf,CADI,EAKJ;IACIU,IAAI,EAAE,MADV;IAEIF,IAAI,EAAE,OAFV;IAGIC,SAAS,EAAER;EAHf,CALI,GAUJ;IACIS,IAAI,EAAE,QADV;IAEIF,IAAI,EAAE,SAFV;IAGIC,SAAS,EAAEP;EAHf,CAVI,CAFc;EAkBtBS,QAAQ,EAAE,CAAC;IACPH,IAAI,EAAE,IADC;IAEPE,IAAI,EAAE,IAFC;IAGPD,SAAS,EAAEV;EAHJ,CAAD;AAlBY,CAAD,CAAzB;AAwBAM,MAAM,CAACO,UAAP,CAAkB,CAACC,EAAD,EAAKC,IAAL,KAAc;EAC5B,IAAIC,QAAQ,GAAGZ,UAAU,CAACa,QAAX,CAAoB,UAApB,CAAf;EACA,IAAIC,MAAJ;EACAC,SAAS,CAACC,UAAV,CAAqBf,OAAO,CAACgB,WAA7B,EAA2C,eAAcL,QAAQ,CAACM,QAAS,6BAA3E,EAAyGC,IAAzG,CAA+GC,GAAD,IAAS;IACnHN,MAAM,GAAGM,GAAG,CAACC,OAAJ,CAAY,CAAZ,EAAeC,OAAf,CAAuBC,QAAhC;EACH,CAFD;EAGAC,OAAO,CAACC,GAAR,CAAYX,MAAZ,EAN4B,CAO5B;;EACA,IAAIY,UAAU,GAAG,EAAjB;EACA,IAAIC,MAAJ;EACAZ,SAAS,CAACC,UAAV,CAAqBf,OAAO,CAAC2B,WAA7B,EAA2C,eAAcd,MAAO,oBAAhE,EAAqFK,IAArF,CAA2FC,GAAD,IAAS;IAC3FO,MAAM,GAAGP,GAAG,CAACC,OAAb;EACH,CAFL,EAV4B,CAaxB;;EACJM,MAAM,CAACE,OAAP,CAAgBC,OAAD,IAAa;IACxB,IAAIA,OAAO,CAACC,OAAR,CAAgBC,IAAhB,KAAyB,CAAzB,IAA8BF,OAAO,CAACC,OAAR,CAAgBC,IAAhB,KAAyB,CAA3D,EAA8D;MAC1DN,UAAU,CAACO,IAAX,CAAgBH,OAAO,CAACC,OAAxB;IACH;EACJ,CAJD;;EAMA,KAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGR,UAAU,CAACS,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;IACxCnB,SAAS,CAACC,UAAV,CAAqBf,OAAO,CAACmC,OAA7B,EAAuC,iBAAgBV,UAAU,CAACQ,CAAD,CAAV,CAAcX,QAAS,aAA9E,EAA4FJ,IAA5F,CAAkGC,GAAD,IAAS;MACtGM,UAAU,CAACQ,CAAD,CAAV,CAAc1B,QAAd,GAAyBY,GAAG,CAACC,OAA7B;IACH,CAFD;EAGH;;EACDrB,UAAU,CAACqC,QAAX,CAAoB,UAApB,EAAgCX,UAAhC;AACH,CA1BD;AA2BA,eAAexB,MAAf"},"metadata":{},"sourceType":"module"}